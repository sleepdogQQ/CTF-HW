# 黑客社CTF
## [CTF網址](https://ctf.hackersir.org/challenges)
### 6/24
- 第一題
    - [SQL](http://140.134.208.86:10013/index.php)
    - ![](https://i.imgur.com/fyGdLyX.png)
    - SQL injectioin就是利用SQL在抓資料時，驗證方式的一些漏洞來越權登入
    - 而通常SQL語法上，再抓帳號和密碼時，是長這樣
    - SELECT * FROM 某個資料庫 WHERE name ='帳號' AND password = '密碼'
    - 所以當我們在帳號輸入'OR"1"="1"#時
    - 前面帳號的'會被後面一個'給結束掉，然後"1"="1"恆為True，又因為OR，所以到這裡，帳號就是會Ture了，但後面還有一個'
    - 所以會用到SQL中的註解符號#來解決這個問題
    - 最後就可以成功登入了
- 第二題
    - [Robot](http://140.134.208.86:10009/)
    - 這題考的是Google搜尋引擎在抓網頁時，有哪些是不要被抓到的，也就會存在一個叫robots.txt的檔案下
    - 所以可以在/後面再加上robots.txt去抓
    - 然後就會出現下面的樣子
    - ![](https://i.imgur.com/kKfPDsT.png)
    - 最後在會面加上/flag.html就會出現這題的答案了
- 第三題
    - [Cookie](http://140.134.208.86:10003/)
    - cookie通常會在你第一次登入時，瀏覽器給你，然後存在電腦本機了，這樣當你下一次進到同一個網站的時候，他就會可以認得你，就不用再重新登入一次了
    - 而這個東西通常會在你進來的第一次就給你
    - 所以你可以在以下兩個地方找到他
    - 第一個
    - ![](https://i.imgur.com/Os07k73.png)
    - 第二個
    - ![](https://i.imgur.com/Oh8kMoB.png)
    - 然後他會長這樣，a%3A3%3A%7Bs%3A7%3A%22user_id%22%3Bi%3A38023%3Bs%3A5%3A%22admin%22%3Bb%3A0%3Bs%3A3%3A%22iid%22%3Bi%3A4663%3B%7D
    - 一副被編碼的樣子，然後去查一下，通常會用ASCII來編碼
    - 於是我們就反向操作啦～
    - 找線上[ASCII Decode](https://www.urldecoder.org)
    - 然後解開就會長這樣
    - a:3:{s:7:"user_id";i:38023;s:5:"admin";b:0;s:3:"iid";i:4663;}
    - 看到admin為0，我們就試著改成1，然後再拿去[編碼器](https://www.urlencoder.org/)編碼
    - 再丟回到這裏
    - ![](https://i.imgur.com/5H58vU9.png)
    - 他就會以admin:1的帳號登入
    - 最後就可以看到答案囉～
- 第四題
    -  [F12](http://140.134.208.86:10018/)
    -  他都告訴你F12了，打開來找Console就會找到他給你的訊息了
- 第五題
    -  [Warm up](http://140.134.208.86:10000/)
    -  熱身，原始碼，答案，棒
### 6/25
- 第六題
    - [JS](http://140.134.208.86:10004/)
    - ~~很棒，很好，很香~~
    - 當你隨便打帳號密碼，網頁卻沒有任何改變時，但他又告訴你不能登入時，你就可以合理懷疑，他在做前端驗證
    - 所以打開你的F12，看Elements的部分
    - ![](https://i.imgur.com/S9A2Vb0.png)
    - 你就會看到有關Sign in的動作
    - 然後順著往下找
    - ![](https://i.imgur.com/jKOne9x.png)
    - 只後看到他的編碼方式是base64
    - 到這裡，找個[解碼網站](https://www.base64decode.net/)，然後丟回去，當if不成立（兩個都要是他指定的密碼）時，他就會執行else
    - 最後你就會成功拿到答案了
- 第七題
    - [Redirect](http://140.134.208.86:10008/)
    - 可以一個網頁，然後複製你要去的網址，記得先開F12，然後再傳送，就會看到一個![](https://i.imgur.com/7tIPWYI.png)
    - 302（301也是）跳轉出現了
    - 重新導向～，所以我們看不到原本Body裡的訊息
    - 簡單來說，我們要跳過「跳轉」這個動作
    - 但基本上在瀏覽器上不是那麼容易
    - 所以我們可以用一個令，叫curl，並且在Terminal上執行，他的意義在於，他會自動忽略跳轉的這個動作，然後我們就可以正常接收本來網頁上的資訊囉～
- 第八題
    - [Hide](http://140.134.208.86:10007/)
    - 這跟php裡的一個指令叫做hide有關
    - ![](https://i.imgur.com/vAeWMEh.png)
    - 如圖，只要在body裡被span標籤，又class=hide的元素
    - 都會無法顯示，所以只要手動破壞他，他就會出來了
    - 但這裡還有一個地方不太正常，就是當你完成上述動作後，會是這樣
    - ![](https://i.imgur.com/ZmkrsR9.png)
    - 這是因為他的style把他們亂移，導致的錯位
    - 以下有兩種方法可以解決
    - 一個是把那一行複製後，重新貼到隨便一個地方就可以了
    - 另一個是這樣
    - ![](https://i.imgur.com/8cxUn7l.jpg)
    - 然後就會出現一個可以輸入javascript的欄位
    - 然後輸入temp1.innText（temp1是這個區塊的變數代表）
    - 這個的意思就是，把這個區塊裡的字元都印出來，且忽略style的改變
    - 所以都會得到我們要的結果
- 第九題
    - [QQ](http://140.134.208.86:12001/)
    - ~~這題只有一百我真是XX媽~~
    - 一開始就連過去，他就會給你他的規則
    - ![](https://i.imgur.com/LpIntyt.png)
    - 首先我們知道他是php的語法，再來只是引用某個檔案並把他修出來給你看，之後就需要知道些php的語法了
    - $的意義是另一個變數（就像var一樣）
    - 而$_GET屬於一種特殊用法，他的值是從url中抓的，像這樣
    - ![](https://i.imgur.com/ziux4Gf.png)
    - 而strpos會從第一個數（也就是0的位置）開始比較，遇到第一個時，回傳他的位置<-這件事很重要
    - die近似於exit的意義，會在結束前執行後面括號裡的東西（可能是字串，也可能是php指令）
        - 注意，他跟echo和print是不同性質的，不要因為他們都會印東西出來就被搞混了
    - 而eval的作用，就是後面括號內的內容，會當作php的指令來執行
    - 所以第一步，我們當然是要在url上令S的值嘛，不然後面要怎麼接呢
    - 然後$_就會接到你給S的值了
    - 然後就是if的部分了，先看會直接導致QQ的情況，也就是if那行假設的情況等於True（又可以說不為0）時，在有可能導致True的情況，也就是"或'不在第一位（0）的時候，或是:confused:，第一位是"，那後面也只能用"，前面用'，那後面也只能用'，因為剛說過，strpos只會回傳**第一個**相符的數的位置，所以只要遇到第一個是就好了，後面可以不管
    - 總而言之，要注意兩點，第一點，當要用上"或'時，只能在一開始使用，第二點是，第ㄧ位用哪個，後面也只能用哪個
    - 把握好這兩點之後，接著往下看eval的函式
    - 剛忘了說substr的意思是直接把括號裡的面數**直接當成字串**貼上，後面的0和16（只會貼16個喔:smirk:）就是他貼上長度的上下限
    - 這裏就要說明一下.的意思了，其實就是+的意思，所以eval這段的意思，就是這樣
    - eval('die("'＋substr($_,0,16)＋'");');
    - 又有什麼意義呢，其實，這個eval所有的內容，是三個字串所組成，這個斷分別如下
    - eval(<font color=red>'die("'</font>+<font color=blue>substr($_,0,16)</font>+<font color=orange>'");'</font>);
    - 是的，所以如果S=$_=哈囉，那實際上就會者這樣
    - eval( 'die("' ＋ '哈囉' ＋ '");' );
    - eval('die("哈囉);'); = die("哈囉");
        - **請不要放棄，一半了**
    - 然後當S=""時，就會和前面和後面的"做互抵，當然這樣是不夠的
    - 剛說過die裡可以放字串，也可以放**php語法**，是的，這才是可以壞壞的地方
    - 那要怎用**加**進去呢，不說了，在""中加..，之後..中間就是可以放php指令的地方了，長這樣
    - ![](https://i.imgur.com/kYbgM2R.png)
    - 然後就要去找找php有什麼指令可以丟上去了
    - 想當然，控制終端機是做得到的，然後你就會查到三種方式執行終端機指令，分別是
        - shell_exec("指令")
        - exec("指令")
        - system("指令")
    - 你輸入完system("ls")後，你就會找到三個檔案，如圖
    - ![](https://i.imgur.com/NGw8xgr.png)
    - 正當你以為接下來應該是雨過天晴時，並沒有，他有限制字數，只能填16個字元，然後你的".."已經佔了4個了
    - 所以只剩下12個字元位置給你放指令
    - 然後你就會發現，基本上，上述三個叫終端機，都太多字了
    - 所以就要談到php中一個特殊用法，反單引號（｀）的用途
    - 只要在php中直接使用｀｀，那中間的字串就會直接當在終端機上使用
    - 然後就要找到可以在10個字元長度下，完成「掃描flag.php檔」的方式了
    - 最後就會用*.php這個可以執行所有這個副檔名的方式
    - 然後記得打開F12
    - 正常狀態下，如果內容是php的語法，瀏覽器會自動將他改成註解的東西
    - 所以你可以在F12找到被註解掉的部分
    - 最後你就可以找到你的flag囉～
    - :innocent::innocent::innocent::innocent::innocent:
### 6/26
- 第十題
    - [commend](http://140.134.208.86:10011/)
    - 大佛題
    - 你會ls，cat
    - 答案就在你面前
- 第十一題
    - [Ajax](http://140.134.208.86:10019/)
    - Ajax可以讓瀏覽器的速度加快
    - 但其新增的內容也會在F12中的Network中抓到
    - 因此只要打開就會看到具體內容了
    - 答案也就在那了
- 第十二題
    - [CuteJS](http://140.134.208.86:10006/)
    - 一開始看到一堆表情符號還真的不知道是在幹嘛
    - 於是隨便抓一個上去Google就知道原來是JavaScript的一種加密手段
    - 於是立馬透過一些關鍵字，找相關的[解碼器](https://cat-in-136.github.io/2010/12/aadecode-decode-encoded-as-aaencode.html)
    - 然後把他丟進去你就會找到你要的CTF了ＷＯＷ
- 第十三題
    - [Header](http://ctf.hackersir.org:10005/)
    - 在開始的時候，他都跟你提示Header了
    - 當然是把Header打開來看看
    - 於是就會看到在Response的Header中，有兩個很有意思的元素
    - ![](https://i.imgur.com/zNVDnd2.png)
    - 分別是X-NextToken和X-Token
    - 而我就想到自訂表頭，然後用Termial丟丟看，於是我就丟出了這個
    - ![](https://i.imgur.com/BB00rNq.png)
    - 原來他是一個一只會回覆新的Token的循環
    - 既然這樣，就開始寫一個Python腳本，並使用其一個叫Requests的函式庫
    - 寫出如下的程式
    - ![](https://i.imgur.com/gSZ1sso.png)
    - 具體上，就是第一次的Token是自定義以外，後來每一次的Token都是上一次傳回來的Header中，名叫X-NextToken的值
    - 然後傳到沒有，或是出現「CTF」這個關鍵字時停止
    - ![](https://i.imgur.com/gdhyhrq.png)
    - 都沒有錯的話就會噴出這題CTF的答案了
- 第十四題
    - [Favi](http://ctf.hackersir.org:12006/)
    - 把Favi拿去Google的時候，會出現一個叫做Favicon的東西
    - 他的用意是把網頁上的圖標改成你上傳的圖片
    - 所以這題其實是要你去找到這個圖片
    - 而在打開原始碼的時候我們就會看到在Header上這樣一段字
    - ![](https://i.imgur.com/Hnaql0b.png)
    - 其中一個就是shortcut icon就是圖標的位置
    - 於是我們把他接在網址後，就會看到一個可以掃的QR code
    - ![](https://i.imgur.com/AfbzokM.png)
    - 再拿手機或可以掃描的裝置，就會看到這題的答案了
- 第十五題
    - 這題是Reverse的題目
    - [easy](https://ctf.hackersir.org/challenges#easy)
    - 一開始拿到時，想說是個檔案，那就掃掃看，不知道會發生什麼事
    - 於是就用Termial的指令掃掃看
    - ![](https://i.imgur.com/wxZps4e.png)
    - 看著看著
    - ![](https://i.imgur.com/sgcGndd.png)
    - 出現了一個Flag_is_me的文字
    - 於是就找到答案了0.0
